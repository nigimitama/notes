---
title: 決定木
date: 2020-11-22
---



# 概要

- **決定木**（decision tree）は、特徴量の値に応じて条件分岐を繰り返して予測値を決めるアルゴリズム。
- 決定木は非線形モデルなので、線形モデルではうまくフィットできない非線形のデータに対して強い。
- バリアンスが比較的大きいとされ、バギングによって



# モデル

## 図的には

![image-20201122202323219](decision_trees.assets/image-20201122202323219.png)

上の図はHastie et al. (2009)より引用している。左下の図が決定木のイメージ図で、$X_1, X_2$というふたつの特徴量からなる特徴空間を条件分岐で区切って$R_1$から$R_5$の領域（葉ノード）を作っている。領域$R_m$に含まれるデータに対する予測値は、各領域$R_m$に含まれる訓練データのサンプルの平均値や最頻値などになる。



## 数式的には

$d$次元の特徴量$\boldsymbol{x}_{i}=(x_{i1}, \cdots, x_{id})$と目的変数$y_i$からなるサンプルサイズ$N$のデータセット$\{\boldsymbol{x}_i, y_i\}_{i=1}^N$があるとする。

決定木は数式的には
$$
f(\boldsymbol{x}) = \sum^M_{m=1} c_m \bold{1}(\boldsymbol{x} \in R_m)
$$
と表現できる。

ここで$R_1, ..., R_M$は決定木が切り分けた$M$個の領域（葉ノード）、$c_m$は各領域での予測値で、回帰ならその領域内のサンプルの目的変数の平均値

$$
\hat{c}_m = \frac{1}{N_m} \sum_{\boldsymbol{x}_i \in R_m} y_i
$$
であり、分類ならノード内の観測値のクラスのうち割合が最大のクラス
$$
\newcommand{\argmax}{\mathop{\rm arg~max}\limits}
\hat{c}_m =\argmax_{k} \left[ \frac{1}{N_m} \sum_{\boldsymbol{x}_i \in R_m} \boldsymbol{1}(y_i = k) \right]
, (k=1,2, \cdots, K)
$$
である。ここで$N_m$は領域$R_m$内のサンプルサイズ$N_m = \#\{x_i \in R_m\}$である。



# 学習アルゴリズム

特徴空間の「分割の良さ」を表す**不純度**（impurity）という指標を基準に分割点を決めていく。最も一般的なアルゴリズムは以下のようなもの。



## 分岐のアルゴリズム

ある基準[^1] を満たすまで、(1) ~ (3)を繰り返す：

(1) ある分岐点$s$を設定し、特徴量$x_j$と比較して領域$R$に含まれるデータを「$x_j > s$を満たすかどうか」で$R_1, R_2$に分ける
$$
R_{1}(j, s) = \{\boldsymbol{x} | x_j \leq s \}, \hspace{1em}
R_{2}(j, s) = \{\boldsymbol{x} | x_j > s \}
$$
(2) 分割後の不純度の和が最小になる$j, s$を探索する
$$
\min_{j, s}
\left[
\min_{c_{1}} \sum_{x_i \in R_{1}(j,s)} (y_i - c_{1})^2 +
\min_{c_{2}} \sum_{x_i \in R_{2}(j,s)} (y_i - c_{2})^2
\right]
$$

$$
= \min_{j,s} [ I(R_{1}(j, s)) + I(R_{2}(j, s))]
$$

(3) 各葉ノードに対して(1), (2)を計算し、不純度の和が最小になる葉を分割する



[^1]: 最大で何回分岐させるか（`max_depth`）とか、一つの葉に含むサンプル数がいくつになるまで（`min_samples_leaf`）とか



## 不純度

回帰の場合は**平均二乗誤差**（MSE）
$$
I(m) = \frac{1}{N_m}\sum_{\boldsymbol{x}_i \in R_m} (y_i - c_m)^2
$$
分類の場合は**ジニ指数**（Gini index）
$$
I(m) = \sum_{k \neq k'} \hat{p}_{mk} \hat{p}_{mk'}
= \sum^K_{k=1} \hat{p}_{mk} (1 - \hat{p}_{mk})
$$
（ここで$\hat{p}_{mk} = \frac{1}{N_m} \sum_{\boldsymbol{x}_i \in R_m} \boldsymbol{1}(y_i = k)$）

や**交差エントロピー**（cross entropy）
$$
I(m) = -\sum^K_{k=1} \hat{p}_{mk} \log \hat{p}_{mk}
$$


などを使う。



## （補足）ジニ指数と交差エントロピーの違い

殆どの場合、大差ない結果になる。わずかにジニ指数のほうが計算が速いらしい。また、CARTはジニ指数、C4.5は交差エントロピーを採用しているらしい

![img](data:image/png;base64,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)

```python
def gini(p):
    # 2class gini index
    p1 = p
    p2 = (1-p)
    return sum([p * (1-p) for p in [p1, p2]])


def crosse(p):
    # 2class class entropy
    p1 = p
    p2 = (1-p)
    return -1 * sum([p * np.log2(p)/2 for p in [p1, p2]])


x = np.linspace(0, 1, 1000)
plt.plot(x, gini(x), label="Gini index")
plt.plot(x, crosse(x), label="cross entropy")
plt.legend()
plt.ylabel("inpurity")
plt.xlabel("p")
plt.show()
```





# 枝刈り

木の分岐をどこかで止めないと、各葉ノードがサンプルサイズ1になるまで学習を続けてしまい、過学習を引き起こす。

最も一般的な決定木のアルゴリズムであるCART（classification and regression tree）では、**コストと複雑度による枝刈り**（cost complexity pruning）という方法で過学習を防ぐ。



## コストと複雑度の規準

ある葉ノード$m$のコストと複雑度の規準は、不純度$I(m)$と正則化パラメータ$\alpha$を用いて
$$
C(m) = I(m) + \alpha
$$
と定義される。

木$T$の葉ノードの数を$|T|$とすると、木全体のコストと複雑度の規準は
$$
C(T) = \sum_{m=1}^{|T|} I(m) + \alpha |T|
$$
となる[^2]。

これを最小化するような部分木を探索して枝刈りを行っていく。



## リンクの強さ

ある非終端ノード$m$と、$m$を根とする部分木$T_m$の規準が
$$
C(T_m) < C(m)
$$
であれば、$m$を葉とした場合よりも、$m$で分岐したほうが良いことになる。



しかし、$\alpha$を大きくしていくと、$C(T_m) = C(m)$となり、そのとき
$$
\alpha = \frac{I(m) - \sum_{m=1}^{|T_m|} I(m)}{(|T_m| - 1)}
$$
となる[^3]。

$\alpha$を$m$の関数とみなして
$$
g(m) = \frac{I(m) - \sum_{m=1}^{|T_m|} I(m)}{(|T_m| - 1)}
$$
と定義する。これをリンクの強さに関する尺度とする。



## 枝刈りのアルゴリズム

1. １つの葉ノードに含まれる学習データ数が任意の数（例えば5個）になるまで木を分岐させ、これを$T^0$とする
2. $k=0$とする
3. すべての非終端ノードについて$g(m)$を計算する
4. $g(m)$が最小値をとるノードを根とする分岐を削除する
5. この木を$T^k$とする
6. $k = k + 1$に値を更新する

$|T^k|=1$になるまで以下の2~4の処理を繰り返す



## 最適な部分木

枝刈りの処理で部分木の系列$T^1, T^2, \cdots, T^k$が得られる

この部分木の系列のどれかが$C(T)$を最小化する木になる

各$k$について交差検証などで汎化誤差を推定しつつ、最良の木を探索する



## 実運用上では

[scikit-learnのDecisionTree](https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html)にもこのコストと複雑度による枝刈りは実装されている（`ccp_alpha`というパラメータ）が、こちらでは「最小の$g(m)$が予め指定した$\alpha$を超えるまで剪定する」というアルゴリズムになっている。（デフォルトでは0になっていて枝刈りは行われない）



[^2]: 単なる総和でなく、ノード内の学習データ数で重み付け和にする方法もある
[^3]: $\begin{align}C(m) &= C(T_m)\\I(m) + \alpha &= \sum_{m=1}^{|T_m|} I(m) + \alpha |T_m|\\I(m) - \sum_{m=1}^{|T_m|} I(m) &= \alpha (|T_m| - 1)\\\end{align}$



# 参考文献

[1.10. Decision Trees — scikit-learn 0.22.2 documentation](https://scikit-learn.org/stable/modules/tree.html#decision-trees)

[Hastie, T., Tibshirani, R., & Friedman, J. (2009). *The elements of statistical learning: data mining, inference, and prediction*. Springer Science & Business Media.](https://web.stanford.edu/~hastie/Papers/ESLII.pdf)









