Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/usr/local/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import numpy as np
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from lightgbm import LGBMClassifier
from tree_influence.explainers import BoostIn

# load iris data
data = load_iris()
X, y = data['data'], data['target']

# use two classes, then split into train and test
idxs = np.where(y != 2)[0]
X, y = X[idxs], y[idxs]
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=1)

# train GBDT model
model = LGBMClassifier().fit(X_train, y_train)

# fit influence estimator
explainer = BoostIn().fit(model, X_train, y_train)

# estimate training influences on each test instance
influence = explainer.get_local_influence(X_test, y_test)  # shape=(no. train, no. test)

# extract influence values for the first test instance
values = influence[:, 0]  # shape=(no. train,)

# sort training examples from:
# - most positively influential (decreases loss of the test instance the most), to
# - most negatively influential (increases loss of the test instance the most)
training_idxs = np.argsort(values)[::-1]
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
Cell [0;32mIn[1], line 5[0m
[1;32m      3[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01msklearn[39;00m[38;5;21;01m.[39;00m[38;5;21;01mmodel_selection[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m train_test_split
[1;32m      4[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mlightgbm[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m LGBMClassifier
[0;32m----> 5[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mtree_influence[39;00m[38;5;21;01m.[39;00m[38;5;21;01mexplainers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m BoostIn
[1;32m      7[0m [38;5;66;03m# load iris data[39;00m
[1;32m      8[0m data [38;5;241m=[39m load_iris()

File [0;32m/usr/local/lib/python3.10/site-packages/tree_influence/__init__.py:1[0m
[0;32m----> 1[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mclasses[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m TreeExplainer

File [0;32m/usr/local/lib/python3.10/site-packages/tree_influence/classes.py:1[0m
[0;32m----> 1[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mexplainers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m BoostIn
[1;32m      2[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mexplainers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m BoostInLE
[1;32m      3[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mexplainers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m BoostInW1

File [0;32m/usr/local/lib/python3.10/site-packages/tree_influence/explainers/__init__.py:1[0m
[0;32m----> 1[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mboostin[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m BoostIn
[1;32m      2[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mboostinLE[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m BoostInLE
[1;32m      3[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mboostinW1[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m BoostInW1

File [0;32m/usr/local/lib/python3.10/site-packages/tree_influence/explainers/boostin.py:5[0m
[1;32m      1[0m [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mtime[39;00m
[1;32m      3[0m [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mnumpy[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[38;5;21;01mnp[39;00m
[0;32m----> 5[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mbase[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Explainer
[1;32m      6[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mparsers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m util
[1;32m      9[0m [38;5;28;01mclass[39;00m[38;5;250m [39m[38;5;21;01mBoostIn[39;00m(Explainer):

File [0;32m/usr/local/lib/python3.10/site-packages/tree_influence/explainers/base.py:6[0m
[1;32m      2[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mabc[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m abstractmethod
[1;32m      4[0m [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mnumpy[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[38;5;21;01mnp[39;00m
[0;32m----> 6[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mparsers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m parse_model
[1;32m      7[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mparsers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m util
[1;32m     10[0m [38;5;28;01mclass[39;00m[38;5;250m [39m[38;5;21;01mExplainer[39;00m([38;5;28mobject[39m):

File [0;32m/usr/local/lib/python3.10/site-packages/tree_influence/explainers/parsers/__init__.py:6[0m
[1;32m      1[0m [38;5;124;03m"""[39;00m
[1;32m      2[0m [38;5;124;03mParse the incoming model into a standardized representation.[39;00m
[1;32m      3[0m [38;5;124;03m"""[39;00m
[1;32m      4[0m [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mnumpy[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[38;5;21;01mnp[39;00m
[0;32m----> 6[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mparser_cb[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m parse_cb_ensemble
[1;32m      7[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mparser_lgb[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m parse_lgb_ensemble
[1;32m      8[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mparser_sk[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m parse_skhgbm_ensemble

File [0;32m/usr/local/lib/python3.10/site-packages/tree_influence/explainers/parsers/parser_cb.py:8[0m
[1;32m      4[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01muuid[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m uuid4
[1;32m      6[0m [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mnumpy[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[38;5;21;01mnp[39;00m
[0;32m----> 8[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01mtree[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Tree
[1;32m     11[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mparse_cb_ensemble[39m(model):
[1;32m     12[0m [38;5;250m    [39m[38;5;124;03m"""[39;00m
[1;32m     13[0m [38;5;124;03m    Parse CatBoost model based on its json representation.[39;00m
[1;32m     14[0m [38;5;124;03m    """[39;00m

File [0;32m/usr/local/lib/python3.10/site-packages/tree_influence/explainers/parsers/tree.py:4[0m
[1;32m      1[0m [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mnumpy[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[38;5;21;01mnp[39;00m
[1;32m      3[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m util
[0;32m----> 4[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01m_tree32[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m _Tree32
[1;32m      5[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01m.[39;00m[38;5;21;01m_tree64[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m _Tree64
[1;32m      8[0m [38;5;28;01mclass[39;00m[38;5;250m [39m[38;5;21;01mTree[39;00m([38;5;28mobject[39m):

File [0;32mtree_influence/explainers/parsers/_tree32.pyx:1[0m, in [0;36minit tree_influence.explainers.parsers._tree32[0;34m()[0m

[0;31mValueError[0m: numpy.dtype size changed, may indicate binary incompatibility. Expected 96 from C header, got 88 from PyObject

