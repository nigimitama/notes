Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/usr/local/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
from semopy.polycorr import polychoric_corr

pd.DataFrame([
    dict(method="積率相関係数を量的変数に適用", value=pearsonr(X[:, 0], X[:, 1]).statistic),
    dict(method="積率相関係数を質的変数に適用", value=D.corr().iloc[0, 1]),
    dict(method="ポリコリック相関係数を質的変数に適用", value=polychoric_corr(D["d1"], D["d2"]))
]).style.format({"value": "{:.3f}"})
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mAttributeError[0m                            Traceback (most recent call last)
Cell [0;32mIn[4], line 6[0m
[1;32m      1[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01msemopy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mpolycorr[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m polychoric_corr
[1;32m      3[0m pd[38;5;241m.[39mDataFrame([
[1;32m      4[0m     [38;5;28mdict[39m(method[38;5;241m=[39m[38;5;124m"[39m[38;5;124m積率相関係数を量的変数に適用[39m[38;5;124m"[39m, value[38;5;241m=[39mpearsonr(X[:, [38;5;241m0[39m], X[:, [38;5;241m1[39m])[38;5;241m.[39mstatistic),
[1;32m      5[0m     [38;5;28mdict[39m(method[38;5;241m=[39m[38;5;124m"[39m[38;5;124m積率相関係数を質的変数に適用[39m[38;5;124m"[39m, value[38;5;241m=[39mD[38;5;241m.[39mcorr()[38;5;241m.[39miloc[[38;5;241m0[39m, [38;5;241m1[39m]),
[0;32m----> 6[0m     [38;5;28mdict[39m(method[38;5;241m=[39m[38;5;124m"[39m[38;5;124mポリコリック相関係数を質的変数に適用[39m[38;5;124m"[39m, value[38;5;241m=[39m[43mpolychoric_corr[49m[43m([49m[43mD[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43md1[39;49m[38;5;124;43m"[39;49m[43m][49m[43m,[49m[43m [49m[43mD[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43md2[39;49m[38;5;124;43m"[39;49m[43m][49m[43m)[49m)
[1;32m      7[0m ])[38;5;241m.[39mstyle[38;5;241m.[39mformat({[38;5;124m"[39m[38;5;124mvalue[39m[38;5;124m"[39m: [38;5;124m"[39m[38;5;132;01m{:.3f}[39;00m[38;5;124m"[39m})

File [0;32m/usr/local/lib/python3.10/site-packages/semopy/polycorr.py:221[0m, in [0;36mpolychoric_corr[0;34m(x, y, x_ints, y_ints)[0m
[1;32m    216[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mcalc_likelihood[39m(r):
[1;32m    217[0m     [38;5;28;01mreturn[39;00m [38;5;241m-[39m[38;5;28msum[39m(np[38;5;241m.[39mlog(bivariate_cdf([x_ints[i], y_ints[j]],
[1;32m    218[0m                                      [x_ints[i [38;5;241m+[39m [38;5;241m1[39m], y_ints[j [38;5;241m+[39m [38;5;241m1[39m]], r)) [38;5;241m*[39m n[i, j]
[1;32m    219[0m                 [38;5;28;01mfor[39;00m i [38;5;129;01min[39;00m [38;5;28mrange[39m(p) [38;5;28;01mfor[39;00m j [38;5;129;01min[39;00m [38;5;28mrange[39m(m))
[0;32m--> 221[0m [38;5;28;01mreturn[39;00m [43mminimize_scalar[49m[43m([49m[43mcalc_likelihood[49m[43m,[49m[43m [49m[43mbounds[49m[38;5;241;43m=[39;49m[43m([49m[38;5;241;43m-[39;49m[38;5;241;43m1[39;49m[43m,[49m[43m [49m[38;5;241;43m1[39;49m[43m)[49m[43m,[49m[43m [49m[43mmethod[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mbounded[39;49m[38;5;124;43m'[39;49m[43m)[49m[38;5;241m.[39mx

File [0;32m/usr/local/lib/python3.10/site-packages/scipy/optimize/_minimize.py:981[0m, in [0;36mminimize_scalar[0;34m(fun, bracket, bounds, args, method, tol, options)[0m
[1;32m    978[0m     [38;5;28;01mif[39;00m bounds [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m    979[0m         [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124m'[39m[38;5;124mThe `bounds` parameter is mandatory for [39m[38;5;124m'[39m
[1;32m    980[0m                          [38;5;124m'[39m[38;5;124mmethod `bounded`.[39m[38;5;124m'[39m)
[0;32m--> 981[0m     res [38;5;241m=[39m [43m_minimize_scalar_bounded[49m[43m([49m[43mfun[49m[43m,[49m[43m [49m[43mbounds[49m[43m,[49m[43m [49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43moptions[49m[43m)[49m
[1;32m    982[0m [38;5;28;01melif[39;00m meth [38;5;241m==[39m [38;5;124m'[39m[38;5;124mgolden[39m[38;5;124m'[39m:
[1;32m    983[0m     res [38;5;241m=[39m _recover_from_bracket_error(_minimize_scalar_golden,
[1;32m    984[0m                                       fun, bracket, args, [38;5;241m*[39m[38;5;241m*[39moptions)

File [0;32m/usr/local/lib/python3.10/site-packages/scipy/optimize/_optimize.py:2298[0m, in [0;36m_minimize_scalar_bounded[0;34m(func, bounds, args, xatol, maxiter, disp, **unknown_options)[0m
[1;32m   2296[0m rat [38;5;241m=[39m e [38;5;241m=[39m [38;5;241m0.0[39m
[1;32m   2297[0m x [38;5;241m=[39m xf
[0;32m-> 2298[0m fx [38;5;241m=[39m [43mfunc[49m[43m([49m[43mx[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m)[49m
[1;32m   2299[0m num [38;5;241m=[39m [38;5;241m1[39m
[1;32m   2300[0m fmin_data [38;5;241m=[39m ([38;5;241m1[39m, xf, fx)

File [0;32m/usr/local/lib/python3.10/site-packages/semopy/polycorr.py:217[0m, in [0;36mpolychoric_corr.<locals>.calc_likelihood[0;34m(r)[0m
[1;32m    216[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mcalc_likelihood[39m(r):
[0;32m--> 217[0m     [38;5;28;01mreturn[39;00m [38;5;241m-[39m[38;5;28;43msum[39;49m[43m([49m[43mnp[49m[38;5;241;43m.[39;49m[43mlog[49m[43m([49m[43mbivariate_cdf[49m[43m([49m[43m[[49m[43mx_ints[49m[43m[[49m[43mi[49m[43m][49m[43m,[49m[43m [49m[43my_ints[49m[43m[[49m[43mj[49m[43m][49m[43m][49m[43m,[49m
[1;32m    218[0m [43m                                     [49m[43m[[49m[43mx_ints[49m[43m[[49m[43mi[49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[38;5;241;43m1[39;49m[43m][49m[43m,[49m[43m [49m[43my_ints[49m[43m[[49m[43mj[49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[38;5;241;43m1[39;49m[43m][49m[43m][49m[43m,[49m[43m [49m[43mr[49m[43m)[49m[43m)[49m[43m [49m[38;5;241;43m*[39;49m[43m [49m[43mn[49m[43m[[49m[43mi[49m[43m,[49m[43m [49m[43mj[49m[43m][49m
[1;32m    219[0m [43m                [49m[38;5;28;43;01mfor[39;49;00m[43m [49m[43mi[49m[43m [49m[38;5;129;43;01min[39;49;00m[43m [49m[38;5;28;43mrange[39;49m[43m([49m[43mp[49m[43m)[49m[43m [49m[38;5;28;43;01mfor[39;49;00m[43m [49m[43mj[49m[43m [49m[38;5;129;43;01min[39;49;00m[43m [49m[38;5;28;43mrange[39;49m[43m([49m[43mm[49m[43m)[49m[43m)[49m

File [0;32m/usr/local/lib/python3.10/site-packages/semopy/polycorr.py:217[0m, in [0;36m<genexpr>[0;34m(.0)[0m
[1;32m    216[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mcalc_likelihood[39m(r):
[0;32m--> 217[0m     [38;5;28;01mreturn[39;00m [38;5;241m-[39m[38;5;28msum[39m(np[38;5;241m.[39mlog([43mbivariate_cdf[49m[43m([49m[43m[[49m[43mx_ints[49m[43m[[49m[43mi[49m[43m][49m[43m,[49m[43m [49m[43my_ints[49m[43m[[49m[43mj[49m[43m][49m[43m][49m[43m,[49m
[1;32m    218[0m [43m                                     [49m[43m[[49m[43mx_ints[49m[43m[[49m[43mi[49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[38;5;241;43m1[39;49m[43m][49m[43m,[49m[43m [49m[43my_ints[49m[43m[[49m[43mj[49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[38;5;241;43m1[39;49m[43m][49m[43m][49m[43m,[49m[43m [49m[43mr[49m[43m)[49m) [38;5;241m*[39m n[i, j]
[1;32m    219[0m                 [38;5;28;01mfor[39;00m i [38;5;129;01min[39;00m [38;5;28mrange[39m(p) [38;5;28;01mfor[39;00m j [38;5;129;01min[39;00m [38;5;28mrange[39m(m))

File [0;32m/usr/local/lib/python3.10/site-packages/semopy/polycorr.py:42[0m, in [0;36mbivariate_cdf[0;34m(lower, upper, corr, means, var)[0m
[1;32m     16[0m [38;5;250m[39m[38;5;124;03m"""[39;00m
[1;32m     17[0m [38;5;124;03mEstimates an integral of bivariate pdf.[39;00m
[1;32m     18[0m 
[0;32m   (...)[0m
[1;32m     39[0m 
[1;32m     40[0m [38;5;124;03m"""[39;00m
[1;32m     41[0m s [38;5;241m=[39m np[38;5;241m.[39marray([[var[[38;5;241m0[39m], corr], [corr, var[[38;5;241m1[39m]]])
[0;32m---> 42[0m [38;5;28;01mreturn[39;00m [43mmvn[49m[38;5;241;43m.[39;49m[43mmvnun[49m(lower, upper, means, s)[[38;5;241m0[39m]

File [0;32m/usr/local/lib/python3.10/site-packages/scipy/stats/mvn.py:15[0m, in [0;36m__getattr__[0;34m(name)[0m
[1;32m     14[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21m__getattr__[39m(name):
[0;32m---> 15[0m     [38;5;28;01mreturn[39;00m [43m_sub_module_deprecation[49m[43m([49m[43msub_package[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mstats[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[43mmodule[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mmvn[39;49m[38;5;124;43m"[39;49m[43m,[49m
[1;32m     16[0m [43m                                   [49m[43mprivate_modules[49m[38;5;241;43m=[39;49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43m_mvn[39;49m[38;5;124;43m"[39;49m[43m][49m[43m,[49m[43m [49m[38;5;28;43mall[39;49m[38;5;241;43m=[39;49m[43m__all__[49m[43m,[49m
[1;32m     17[0m [43m                                   [49m[43mattribute[49m[38;5;241;43m=[39;49m[43mname[49m[43m)[49m

File [0;32m/usr/local/lib/python3.10/site-packages/scipy/_lib/deprecation.py:45[0m, in [0;36m_sub_module_deprecation[0;34m(sub_package, module, private_modules, all, attribute, correct_module, dep_version)[0m
[1;32m     42[0m     correct_import [38;5;241m=[39m [38;5;124mf[39m[38;5;124m"[39m[38;5;124mscipy.[39m[38;5;132;01m{[39;00msub_package[38;5;132;01m}[39;00m[38;5;124m"[39m
[1;32m     44[0m [38;5;28;01mif[39;00m attribute [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m [38;5;28mall[39m:
[0;32m---> 45[0m     [38;5;28;01mraise[39;00m [38;5;167;01mAttributeError[39;00m(
[1;32m     46[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124m`scipy.[39m[38;5;132;01m{[39;00msub_package[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;132;01m{[39;00mmodule[38;5;132;01m}[39;00m[38;5;124m` has no attribute `[39m[38;5;132;01m{[39;00mattribute[38;5;132;01m}[39;00m[38;5;124m`; [39m[38;5;124m"[39m
[1;32m     47[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mfurthermore, `scipy.[39m[38;5;132;01m{[39;00msub_package[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;132;01m{[39;00mmodule[38;5;132;01m}[39;00m[38;5;124m` is deprecated [39m[38;5;124m"[39m
[1;32m     48[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mand will be removed in SciPy 2.0.0.[39m[38;5;124m"[39m
[1;32m     49[0m     )
[1;32m     51[0m attr [38;5;241m=[39m [38;5;28mgetattr[39m(import_module(correct_import), attribute, [38;5;28;01mNone[39;00m)
[1;32m     53[0m [38;5;28;01mif[39;00m attr [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:

[0;31mAttributeError[0m: `scipy.stats.mvn` has no attribute `mvnun`; furthermore, `scipy.stats.mvn` is deprecated and will be removed in SciPy 2.0.0.

