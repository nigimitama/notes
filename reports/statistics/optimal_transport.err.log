Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/usr/local/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/local/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/usr/local/lib/python3.10/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import numpy as np

# 離散分布を想定
a = np.array([0.2,0.5,0.2,0.1])
b = np.array([0.3,0.3,0.4,0.0])
C = np.array([
    [0,2,2,2],
    [2,0,1,2],
    [2,1,0,2],
    [2,2,2,0]
])


import cvxpy as cp
n = C.shape[0]
P = cp.Variable((n, n))

objective = cp.Minimize(cp.multiply(C, P).sum())
constraints = [
    P >= 0,
    cp.sum(P, axis=1) == a, # jについて総和をとったものがa_iと等しい
    cp.sum(P, axis=0) == b, # iについて総和をとったものがb_jと等しい
]
prob = cp.Problem(objective, constraints)
prob.solve()
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mImportError[0m                               Traceback (most recent call last)
Cell [0;32mIn[1], line 14[0m
[1;32m      5[0m b [38;5;241m=[39m np[38;5;241m.[39marray([[38;5;241m0.3[39m,[38;5;241m0.3[39m,[38;5;241m0.4[39m,[38;5;241m0.0[39m])
[1;32m      6[0m C [38;5;241m=[39m np[38;5;241m.[39marray([
[1;32m      7[0m     [[38;5;241m0[39m,[38;5;241m2[39m,[38;5;241m2[39m,[38;5;241m2[39m],
[1;32m      8[0m     [[38;5;241m2[39m,[38;5;241m0[39m,[38;5;241m1[39m,[38;5;241m2[39m],
[1;32m      9[0m     [[38;5;241m2[39m,[38;5;241m1[39m,[38;5;241m0[39m,[38;5;241m2[39m],
[1;32m     10[0m     [[38;5;241m2[39m,[38;5;241m2[39m,[38;5;241m2[39m,[38;5;241m0[39m]
[1;32m     11[0m ])
[0;32m---> 14[0m [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[38;5;21;01mcp[39;00m
[1;32m     15[0m n [38;5;241m=[39m C[38;5;241m.[39mshape[[38;5;241m0[39m]
[1;32m     16[0m P [38;5;241m=[39m cp[38;5;241m.[39mVariable((n, n))

File [0;32m/usr/local/lib/python3.10/site-packages/cvxpy/__init__.py:56[0m
[1;32m     50[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mexpressions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mvariable[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Variable [38;5;28;01mas[39;00m Variable
[1;32m     51[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mproblems[39;00m[38;5;21;01m.[39;00m[38;5;21;01mobjective[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m (
[1;32m     52[0m     Maximize [38;5;28;01mas[39;00m Maximize,
[1;32m     53[0m     Minimize [38;5;28;01mas[39;00m Minimize,
[1;32m     54[0m     Objective [38;5;28;01mas[39;00m Objective,
[1;32m     55[0m )
[0;32m---> 56[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mproblems[39;00m[38;5;21;01m.[39;00m[38;5;21;01mproblem[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Problem [38;5;28;01mas[39;00m Problem
[1;32m     57[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtransforms[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m (
[1;32m     58[0m     linearize [38;5;28;01mas[39;00m linearize,
[1;32m     59[0m     partial_optimize [38;5;28;01mas[39;00m partial_optimize,
[1;32m     60[0m     suppfunc [38;5;28;01mas[39;00m suppfunc,
[1;32m     61[0m )
[1;32m     62[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01msolvers[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdefines[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m installed_solvers [38;5;28;01mas[39;00m installed_solvers

File [0;32m/usr/local/lib/python3.10/site-packages/cvxpy/problems/problem.py:38[0m
[1;32m     36[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01minterface[39;00m[38;5;21;01m.[39;00m[38;5;21;01mmatrix_utilities[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m scalar_value
[1;32m     37[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mproblems[39;00m[38;5;21;01m.[39;00m[38;5;21;01mobjective[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Maximize, Minimize
[0;32m---> 38[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m InverseData
[1;32m     39[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mchain[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Chain
[1;32m     40[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdgp2dcp[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdgp2dcp[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Dgp2Dcp

File [0;32m/usr/local/lib/python3.10/site-packages/cvxpy/reductions/__init__.py:24[0m
[1;32m     22[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcvx_attr2constr[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m CvxAttr2Constr
[1;32m     23[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdcp2cone[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcone_matrix_stuffing[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m ConeMatrixStuffing
[0;32m---> 24[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdcp2cone[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdcp2cone[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Dcp2Cone
[1;32m     25[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdgp2dcp[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdgp2dcp[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Dgp2Dcp
[1;32m     26[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdqcp2dcp[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdqcp2dcp[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Dqcp2Dcp

File [0;32m/usr/local/lib/python3.10/site-packages/cvxpy/reductions/dcp2cone/dcp2cone.py:27[0m
[1;32m     25[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdcp2cone[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcanonicalizers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m CANON_METHODS [38;5;28;01mas[39;00m cone_canon_methods
[1;32m     26[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01minverse_data[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m InverseData
[0;32m---> 27[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mqp2quad_form[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcanonicalizers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m QUAD_CANON_METHODS [38;5;28;01mas[39;00m quad_canon_methods
[1;32m     30[0m [38;5;28;01mclass[39;00m[38;5;250m [39m[38;5;21;01mDcp2Cone[39;00m(Canonicalization):
[1;32m     31[0m [38;5;250m    [39m[38;5;124;03m"""Reduce DCP problems to a conic form.[39;00m
[1;32m     32[0m 
[1;32m     33[0m [38;5;124;03m    This reduction takes as input (minimization) DCP problems and converts[39;00m
[1;32m     34[0m [38;5;124;03m    them into problems with affine or quadratic objectives and conic[39;00m
[1;32m     35[0m [38;5;124;03m    constraints whose arguments are affine.[39;00m
[1;32m     36[0m [38;5;124;03m    """[39;00m

File [0;32m/usr/local/lib/python3.10/site-packages/cvxpy/reductions/qp2quad_form/canonicalizers/__init__.py:24[0m
[1;32m     22[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mqp2quad_form[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcanonicalizers[39;00m[38;5;21;01m.[39;00m[38;5;21;01mpower_canon[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m [38;5;241m*[39m
[1;32m     23[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mqp2quad_form[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcanonicalizers[39;00m[38;5;21;01m.[39;00m[38;5;21;01mquad_form_canon[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m [38;5;241m*[39m
[0;32m---> 24[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreductions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mqp2quad_form[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcanonicalizers[39;00m[38;5;21;01m.[39;00m[38;5;21;01mquad_over_lin_canon[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m [38;5;241m*[39m
[1;32m     25[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtransforms[39;00m[38;5;21;01m.[39;00m[38;5;21;01mindicator[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m indicator
[1;32m     27[0m [38;5;66;03m# TODO: remove pwl canonicalize methods, use EliminatePwl reduction instead[39;00m
[1;32m     28[0m 
[1;32m     29[0m [38;5;66;03m# Conic canonicalization methods.[39;00m

File [0;32m/usr/local/lib/python3.10/site-packages/cvxpy/reductions/qp2quad_form/canonicalizers/quad_over_lin_canon.py:17[0m
[1;32m      1[0m [38;5;124;03m"""[39;00m
[1;32m      2[0m [38;5;124;03mCopyright 2017 Robin Verschueren[39;00m
[1;32m      3[0m 
[0;32m   (...)[0m
[1;32m     14[0m [38;5;124;03mlimitations under the License.[39;00m
[1;32m     15[0m [38;5;124;03m"""[39;00m
[0;32m---> 17[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mscipy[39;00m[38;5;21;01m.[39;00m[38;5;21;01msparse[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m eye_array
[1;32m     19[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01matoms[39;00m[38;5;21;01m.[39;00m[38;5;21;01mquad_form[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m SymbolicQuadForm
[1;32m     20[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mcvxpy[39;00m[38;5;21;01m.[39;00m[38;5;21;01mexpressions[39;00m[38;5;21;01m.[39;00m[38;5;21;01mvariable[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Variable

[0;31mImportError[0m: cannot import name 'eye_array' from 'scipy.sparse' (/usr/local/lib/python3.10/site-packages/scipy/sparse/__init__.py)

