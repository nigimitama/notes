<!DOCTYPE html>
<html>
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-GXSWJY51EG"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-GXSWJY51EG');
  </script>

  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

  <script src="https://kit.fontawesome.com/95678975f3.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Frank+Ruhl+Libre|Roboto" rel="stylesheet">
  <link href="modules/progress-nav/normalize.css" rel="stylesheet" type="text/css" />
  <link href="modules/progress-nav/style.css" rel="stylesheet" type="text/css" />

    <meta name="dcterms.date" content="2020-11-22">
  <title>盆暗の勉強メモ – 決定木</title>
  <style type="text/css">code{white-space: pre;}</style>

  <style type="text/css">
    a.sourceLine { display: inline-block; line-height: 1.25; }
    a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
    a.sourceLine:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode { white-space: pre; position: relative; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    code.sourceCode { white-space: pre-wrap; }
    a.sourceLine { text-indent: -1em; padding-left: 1em; }
    }
    pre.numberSource a.sourceLine
      { position: relative; left: -4em; }
    pre.numberSource a.sourceLine::before
      { content: attr(title);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; pointer-events: all; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { background-color: #f8f8f8; }
    @media screen {
    a.sourceLine::before { text-decoration: underline; }
    }
    code span.al { color: #ef2929; } /* Alert */
    code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #c4a000; } /* Attribute */
    code span.bn { color: #0000cf; } /* BaseN */
    code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4e9a06; } /* Char */
    code span.cn { color: #000000; } /* Constant */
    code span.co { color: #8f5902; font-style: italic; } /* Comment */
    code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
    code span.dt { color: #204a87; } /* DataType */
    code span.dv { color: #0000cf; } /* DecVal */
    code span.er { color: #a40000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #0000cf; } /* Float */
    code span.fu { color: #000000; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
    code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
    code span.ot { color: #8f5902; } /* Other */
    code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
    code span.sc { color: #000000; } /* SpecialChar */
    code span.ss { color: #4e9a06; } /* SpecialString */
    code span.st { color: #4e9a06; } /* String */
    code span.va { color: #000000; } /* Variable */
    code span.vs { color: #4e9a06; } /* VerbatimString */
    code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
  </style>


  <link rel="stylesheet" href="modules/style.css">

<script src="/usr/share/javascript/mathjax/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>


</head>
<body>
<header>
    <div class="logo-area p-4">
        <a href="index.html">盆暗の勉強メモ</a>
    </div>

    <nav class="navbar px-4 py-1 navbar-expand-lg navbar-light bg-light">
        <ul class="navbar-nav">
            <li class="nav-item"><a class="nav-link" href="data_science.html"><i class="fas fa-chart-bar"></i> Data Science</a></li>
            <li class="nav-item"><a class="nav-link" href="engineering.html"><i class="fas fa-file-code"></i> Software Engineering</a></li>
            <li class="nav-item"><a class="nav-link" href="mathematics.html"><i class="fas fa-square-root-alt"></i> Mathematics</a></li>
        </ul>
    </nav>
</header>  <main class="py-2">
  <!-- table of contents -->
      <nav class="toc" id="TOC">
    <ul>
    <li><a href="#概要">概要</a></li>
    <li><a href="#モデル">モデル</a><ul>
    <li><a href="#図的には">図的には</a></li>
    <li><a href="#数式的には">数式的には</a></li>
    </ul></li>
    <li><a href="#学習アルゴリズム">学習アルゴリズム</a><ul>
    <li><a href="#分岐のアルゴリズム">分岐のアルゴリズム</a></li>
    <li><a href="#不純度">不純度</a></li>
    <li><a href="#補足ジニ指数と交差エントロピーの違い">（補足）ジニ指数と交差エントロピーの違い</a></li>
    </ul></li>
    <li><a href="#枝刈り">枝刈り</a><ul>
    <li><a href="#コストと複雑度の規準">コストと複雑度の規準</a></li>
    <li><a href="#リンクの強さ">リンクの強さ</a></li>
    <li><a href="#枝刈りのアルゴリズム">枝刈りのアルゴリズム</a></li>
    <li><a href="#最適な部分木">最適な部分木</a></li>
    <li><a href="#実運用上では">実運用上では</a></li>
    </ul></li>
    <li><a href="#参考文献">参考文献</a></li>
    </ul>
      <!-- svg for progress-nav -->
      <svg class="toc-marker" width="200" height="200" xmlns="http://www.w3.org/2000/svg">
        <path stroke="dimgray" stroke-width="3" fill="transparent" stroke-dasharray="0, 0, 0, 1000" stroke-linecap="round" stroke-linejoin="round" transform="translate(-0.5, -0.5)" />
      </svg>
    </nav>
    
  <!-- main contents -->
    
    <!-- contents header -->
        <div>
      <h1 class="title">決定木</h1>
                        <p class="date">2020-11-22</p>
          </div>
    
    <!-- contents body -->
    <article class="contents">
<h1 id="概要">概要</h1>
<ul>
<li><strong>決定木</strong>（decision tree）は、特徴量の値に応じて条件分岐を繰り返して予測値を決めるアルゴリズム。</li>
<li>決定木は非線形モデルなので、線形モデルではうまくフィットできない非線形のデータに対して強い。</li>
<li>バリアンスが比較的大きいとされ、バギングによって</li>
</ul>
<h1 id="モデル">モデル</h1>
<h2 id="図的には">図的には</h2>
<figure>
<img src="decision_trees.assets/image-20201122202323219.png" alt="image-20201122202323219" /><figcaption>image-20201122202323219</figcaption>
</figure>
<p>上の図はHastie et al. (2009)より引用している。左下の図が決定木のイメージ図で、<span class="math inline">\(X_1, X_2\)</span>というふたつの特徴量からなる特徴空間を条件分岐で区切って<span class="math inline">\(R_1\)</span>から<span class="math inline">\(R_5\)</span>の領域（葉ノード）を作っている。領域<span class="math inline">\(R_m\)</span>に含まれるデータに対する予測値は、各領域<span class="math inline">\(R_m\)</span>に含まれる訓練データのサンプルの平均値や最頻値などになる。</p>
<h2 id="数式的には">数式的には</h2>
<p><span class="math inline">\(d\)</span>次元の特徴量<span class="math inline">\(\boldsymbol{x}_{i}=(x_{i1}, \cdots, x_{id})\)</span>と目的変数<span class="math inline">\(y_i\)</span>からなるサンプルサイズ<span class="math inline">\(N\)</span>のデータセット<span class="math inline">\(\{\boldsymbol{x}_i, y_i\}_{i=1}^N\)</span>があるとする。</p>
<p>決定木は数式的には <span class="math display">\[
f(\boldsymbol{x}) = \sum^M_{m=1} c_m \bold{1}(\boldsymbol{x} \in R_m)
\]</span> と表現できる。</p>
<p>ここで<span class="math inline">\(R_1, ..., R_M\)</span>は決定木が切り分けた<span class="math inline">\(M\)</span>個の領域（葉ノード）、<span class="math inline">\(c_m\)</span>は各領域での予測値で、回帰ならその領域内のサンプルの目的変数の平均値</p>
<p><span class="math display">\[
\hat{c}_m = \frac{1}{N_m} \sum_{\boldsymbol{x}_i \in R_m} y_i
\]</span> であり、分類ならノード内の観測値のクラスのうち割合が最大のクラス <span class="math display">\[
\newcommand{\argmax}{\mathop{\rm arg~max}\limits}
\hat{c}_m =\argmax_{k} \left[ \frac{1}{N_m} \sum_{\boldsymbol{x}_i \in R_m} \boldsymbol{1}(y_i = k) \right]
, (k=1,2, \cdots, K)
\]</span> である。ここで<span class="math inline">\(N_m\)</span>は領域<span class="math inline">\(R_m\)</span>内のサンプルサイズ<span class="math inline">\(N_m = \#\{x_i \in R_m\}\)</span>である。</p>
<h1 id="学習アルゴリズム">学習アルゴリズム</h1>
<p>特徴空間の「分割の良さ」を表す<strong>不純度</strong>（impurity）という指標を基準に分割点を決めていく。最も一般的なアルゴリズムは以下のようなもの。</p>
<h2 id="分岐のアルゴリズム">分岐のアルゴリズム</h2>
<p>ある基準<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> を満たすまで、(1) ~ (3)を繰り返す：</p>
<ol type="1">
<li>ある分岐点<span class="math inline">\(s\)</span>を設定し、特徴量<span class="math inline">\(x_j\)</span>と比較して領域<span class="math inline">\(R\)</span>に含まれるデータを「<span class="math inline">\(x_j &gt; s\)</span>を満たすかどうか」で<span class="math inline">\(R_1, R_2\)</span>に分ける <span class="math display">\[
R_{1}(j, s) = \{\boldsymbol{x} | x_j \leq s \}, \hspace{1em}
R_{2}(j, s) = \{\boldsymbol{x} | x_j &gt; s \}
\]</span></li>
<li>分割後の不純度の和が最小になる<span class="math inline">\(j, s\)</span>を探索する <span class="math display">\[
\min_{j, s}
\left[
\min_{c_{1}} \sum_{x_i \in R_{1}(j,s)} (y_i - c_{1})^2 +
\min_{c_{2}} \sum_{x_i \in R_{2}(j,s)} (y_i - c_{2})^2
\right]
\]</span></li>
</ol>
<p><span class="math display">\[
= \min_{j,s} [ I(R_{1}(j, s)) + I(R_{2}(j, s))]
\]</span></p>
<ol start="3" type="1">
<li>各葉ノードに対して(1), (2)を計算し、不純度の和が最小になる葉を分割する</li>
</ol>
<h2 id="不純度">不純度</h2>
<p>回帰の場合は<strong>平均二乗誤差</strong>（MSE） <span class="math display">\[
I(m) = \frac{1}{N_m}\sum_{\boldsymbol{x}_i \in R_m} (y_i - c_m)^2
\]</span> 分類の場合は<strong>ジニ指数</strong>（Gini index） <span class="math display">\[
I(m) = \sum_{k \neq k&#39;} \hat{p}_{mk} \hat{p}_{mk&#39;}
= \sum^K_{k=1} \hat{p}_{mk} (1 - \hat{p}_{mk})
\]</span> （ここで<span class="math inline">\(\hat{p}_{mk} = \frac{1}{N_m} \sum_{\boldsymbol{x}_i \in R_m} \boldsymbol{1}(y_i = k)\)</span>）</p>
<p>や<strong>交差エントロピー</strong>（cross entropy） <span class="math display">\[
I(m) = -\sum^K_{k=1} \hat{p}_{mk} \log \hat{p}_{mk}
\]</span></p>
<p>などを使う。</p>
<h2 id="補足ジニ指数と交差エントロピーの違い">（補足）ジニ指数と交差エントロピーの違い</h2>
<p>殆どの場合、大差ない結果になる。わずかにジニ指数のほうが計算が速いらしい。また、CARTはジニ指数、C4.5は交差エントロピーを採用しているらしい</p>
<figure>
<img src="data:image/png;base64,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" alt="img" /><figcaption>img</figcaption>
</figure>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">def</span> gini(p):</a>
<a class="sourceLine" id="cb1-2" title="2">    <span class="co"># 2class gini index</span></a>
<a class="sourceLine" id="cb1-3" title="3">    p1 <span class="op">=</span> p</a>
<a class="sourceLine" id="cb1-4" title="4">    p2 <span class="op">=</span> (<span class="dv">1</span><span class="op">-</span>p)</a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="cf">return</span> <span class="bu">sum</span>([p <span class="op">*</span> (<span class="dv">1</span><span class="op">-</span>p) <span class="cf">for</span> p <span class="kw">in</span> [p1, p2]])</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">def</span> crosse(p):</a>
<a class="sourceLine" id="cb1-9" title="9">    <span class="co"># 2class class entropy</span></a>
<a class="sourceLine" id="cb1-10" title="10">    p1 <span class="op">=</span> p</a>
<a class="sourceLine" id="cb1-11" title="11">    p2 <span class="op">=</span> (<span class="dv">1</span><span class="op">-</span>p)</a>
<a class="sourceLine" id="cb1-12" title="12">    <span class="cf">return</span> <span class="dv">-1</span> <span class="op">*</span> <span class="bu">sum</span>([p <span class="op">*</span> np.log2(p)<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> p <span class="kw">in</span> [p1, p2]])</a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14"></a>
<a class="sourceLine" id="cb1-15" title="15">x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb1-16" title="16">plt.plot(x, gini(x), label<span class="op">=</span><span class="st">&quot;Gini index&quot;</span>)</a>
<a class="sourceLine" id="cb1-17" title="17">plt.plot(x, crosse(x), label<span class="op">=</span><span class="st">&quot;cross entropy&quot;</span>)</a>
<a class="sourceLine" id="cb1-18" title="18">plt.legend()</a>
<a class="sourceLine" id="cb1-19" title="19">plt.ylabel(<span class="st">&quot;inpurity&quot;</span>)</a>
<a class="sourceLine" id="cb1-20" title="20">plt.xlabel(<span class="st">&quot;p&quot;</span>)</a>
<a class="sourceLine" id="cb1-21" title="21">plt.show()</a></code></pre></div>
<h1 id="枝刈り">枝刈り</h1>
<p>木の分岐をどこかで止めないと、各葉ノードがサンプルサイズ1になるまで学習を続けてしまい、過学習を引き起こす。</p>
<p>最も一般的な決定木のアルゴリズムであるCART（classification and regression tree）では、<strong>コストと複雑度による枝刈り</strong>（cost complexity pruning）という方法で過学習を防ぐ。</p>
<h2 id="コストと複雑度の規準">コストと複雑度の規準</h2>
<p>ある葉ノード<span class="math inline">\(m\)</span>のコストと複雑度の規準は、不純度<span class="math inline">\(I(m)\)</span>と正則化パラメータ<span class="math inline">\(\alpha\)</span>を用いて <span class="math display">\[
C(m) = I(m) + \alpha
\]</span> と定義される。</p>
<p>木<span class="math inline">\(T\)</span>の葉ノードの数を<span class="math inline">\(|T|\)</span>とすると、木全体のコストと複雑度の規準は <span class="math display">\[
C(T) = \sum_{m=1}^{|T|} I(m) + \alpha |T|
\]</span> となる<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>。</p>
<p>これを最小化するような部分木を探索して枝刈りを行っていく。</p>
<h2 id="リンクの強さ">リンクの強さ</h2>
<p>ある非終端ノード<span class="math inline">\(m\)</span>と、<span class="math inline">\(m\)</span>を根とする部分木<span class="math inline">\(T_m\)</span>の規準が <span class="math display">\[
C(T_m) &lt; C(m)
\]</span> であれば、<span class="math inline">\(m\)</span>を葉とした場合よりも、<span class="math inline">\(m\)</span>で分岐したほうが良いことになる。</p>
<p>しかし、<span class="math inline">\(\alpha\)</span>を大きくしていくと、<span class="math inline">\(C(T_m) = C(m)\)</span>となり、そのとき <span class="math display">\[
\alpha = \frac{I(m) - \sum_{m=1}^{|T_m|} I(m)}{(|T_m| - 1)}
\]</span> となる<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>。</p>
<p><span class="math inline">\(\alpha\)</span>を<span class="math inline">\(m\)</span>の関数とみなして <span class="math display">\[
g(m) = \frac{I(m) - \sum_{m=1}^{|T_m|} I(m)}{(|T_m| - 1)}
\]</span> と定義する。これをリンクの強さに関する尺度とする。</p>
<h2 id="枝刈りのアルゴリズム">枝刈りのアルゴリズム</h2>
<ol type="1">
<li>１つの葉ノードに含まれる学習データ数が任意の数（例えば5個）になるまで木を分岐させ、これを<span class="math inline">\(T^0\)</span>とする</li>
<li><span class="math inline">\(k=0\)</span>とする</li>
<li>すべての非終端ノードについて<span class="math inline">\(g(m)\)</span>を計算する</li>
<li><span class="math inline">\(g(m)\)</span>が最小値をとるノードを根とする分岐を削除する</li>
<li>この木を<span class="math inline">\(T^k\)</span>とする</li>
<li><span class="math inline">\(k = k + 1\)</span>に値を更新する</li>
</ol>
<p><span class="math inline">\(|T^k|=1\)</span>になるまで以下の2~4の処理を繰り返す</p>
<h2 id="最適な部分木">最適な部分木</h2>
<p>枝刈りの処理で部分木の系列<span class="math inline">\(T^1, T^2, \cdots, T^k\)</span>が得られる</p>
<p>この部分木の系列のどれかが<span class="math inline">\(C(T)\)</span>を最小化する木になる</p>
<p>各<span class="math inline">\(k\)</span>について交差検証などで汎化誤差を推定しつつ、最良の木を探索する</p>
<h2 id="実運用上では">実運用上では</h2>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html">scikit-learnのDecisionTree</a>にもこのコストと複雑度による枝刈りは実装されている（<code>ccp_alpha</code>というパラメータ）が、こちらでは「最小の<span class="math inline">\(g(m)\)</span>が予め指定した<span class="math inline">\(\alpha\)</span>を超えるまで剪定する」というアルゴリズムになっている。（デフォルトでは0になっていて枝刈りは行われない）</p>
<h1 id="参考文献">参考文献</h1>
<p><a href="https://scikit-learn.org/stable/modules/tree.html#decision-trees">1.10. Decision Trees — scikit-learn 0.22.2 documentation</a></p>
<p><a href="https://web.stanford.edu/~hastie/Papers/ESLII.pdf">Hastie, T., Tibshirani, R., &amp; Friedman, J. (2009). <em>The elements of statistical learning: data mining, inference, and prediction</em>. Springer Science &amp; Business Media.</a></p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>最大で何回分岐させるか（<code>max_depth</code>）とか、一つの葉に含むサンプル数がいくつになるまで（<code>min_samples_leaf</code>）とか<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>単なる総和でなく、ノード内の学習データ数で重み付け和にする方法もある<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p><span class="math inline">\(\begin{align}C(m) &amp;= C(T_m)\\I(m) + \alpha &amp;= \sum_{m=1}^{|T_m|} I(m) + \alpha |T_m|\\I(m) - \sum_{m=1}^{|T_m|} I(m) &amp;= \alpha (|T_m| - 1)\\\end{align}\)</span><a href="#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</section> <!-- NOTE: ここにインデントをつけるとcode部のインデントが壊れる -->
    </article>
    
      </main>

  <script src="modules/progress-nav/script.js"></script>
</body>
</html>